{"errors": [], "interfile_languages_used": [], "paths": {"scanned": ["/Users/USERNAME/Downloads/JavaVulnerableLab-master/Dockerfile", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/LICENSE", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/README.md", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/default-tomcat.xml", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/docker-compose.yml", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/pom.xml", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/AddPage.java", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/EmailCheck.java", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/ForwardMe.java", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/Install.java", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/LoginValidator.java", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/Logout.java", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/Open.java", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/Register.java", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/SendMessage.java", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/UsernameCheck.java", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/XPathQuery.java", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/xxe.java", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/model/DBConnect.java", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/model/HashMe.java", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/model/orm/Users.java", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/resources/Users.hbm.xml", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/ForgotPassword.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/META-INF/context.xml", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/Register.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/WEB-INF/AdminPanel.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/WEB-INF/config.properties", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/WEB-INF/users.xml", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/WEB-INF/web.xml", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/admin/AddPage.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/admin/Configure.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/admin/admin.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/admin/adminlogin.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/admin/index.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/admin/manageusers.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/changeCardDetails.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/docs/doc1.pdf", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/docs/exampledoc.pdf", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/footer.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/header.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/images/Thumbs.db", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/images/bg.png", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/index.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/install.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/login.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/myprofile.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/robots.txt", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/style.css", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/DisplayMessage.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/Injection/1.xsl", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/Injection/2.xsl", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/Injection/Users.hbm.xml", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/Injection/courses.xml", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/Injection/orm.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/Injection/xpath_login.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/Injection/xslt.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/Injection/xxe.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/Messages.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/SendMessage.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/UserDetails.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/baasm/SiteTitle.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/baasm/URLRewriting.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/csrf/change-info.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/csrf/changepassword.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/forum.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/forumUsersList.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/forumposts.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/idor/change-email.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/idor/download.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/mfac/SearchEngines.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/sde/hash.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/securitymisconfig/pages.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/sqli/download.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/sqli/download_id.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/sqli/download_id_union.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/sqli/union2.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/unvalidated/OpenForward.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/unvalidated/OpenURL.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/xss/flash/exss.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/xss/flash/xss1.swf", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/xss/flash/xss2.swf", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/xss/search.jsp", "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/webapp/vulnerability/xss/xss4.jsp"]}, "results": [{"check_id": "java.lang.security.httpservlet-path-traversal.httpservlet-path-traversal", "end": {"col": 38, "line": 45, "offset": 1533}, "extra": {"dataflow_trace": {"intermediate_vars": [{"content": "fileName", "location": {"end": {"col": 27, "line": 39, "offset": 1220}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/AddPage.java", "start": {"col": 19, "line": 39, "offset": 1212}}}, {"content": "filePath", "location": {"end": {"col": 28, "line": 44, "offset": 1472}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/AddPage.java", "start": {"col": 20, "line": 44, "offset": 1464}}}], "taint_sink": ["CliLoc", [{"end": {"col": 38, "line": 45, "offset": 1533}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/AddPage.java", "start": {"col": 18, "line": 45, "offset": 1513}}, "f=new File(filePath)"]], "taint_source": ["CliLoc", [{"end": {"col": 35, "line": 39, "offset": 1228}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/AddPage.java", "start": {"col": 28, "line": 39, "offset": 1221}}, "request"]]}, "engine_kind": "OSS", "fingerprint": "a928d8830c2b2bdf0fd970e22724545e7858b80ad684e9ba526154789ba6e9417f0dfd8f1f6f8a98ba9c42af2a97fb128f0fa7cc05d608ef734e5594292a0991_0", "is_ignored": false, "lines": "            File f=new File(filePath);", "message": "Detected a potential path traversal. A malicious actor could control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are sanitized. You may also consider using a utility method such as org.apache.commons.io.FilenameUtils.getName(...) to only retrieve the file name from the path.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "HIGH", "owasp": ["A05:2017 - Broken Access Control", "A01:2021 - Broken Access Control"], "references": ["https://www.owasp.org/index.php/Path_Traversal"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9160, "rule_id": "NbUk7X", "rv_id": 833992, "url": "https://semgrep.dev/playground/r/ExTrDDe/java.lang.security.httpservlet-path-traversal.httpservlet-path-traversal", "version_id": "ExTrDDe"}}, "shortlink": "https://sg.run/oxXN", "source": "https://semgrep.dev/r/java.lang.security.httpservlet-path-traversal.httpservlet-path-traversal", "source-rule-url": "https://find-sec-bugs.github.io/bugs.htm#PATH_TRAVERSAL_IN", "subcategory": ["vuln"], "technology": ["java"], "vulnerability_class": ["Path Traversal"]}, "metavars": {"$FILE": {"abstract_content": "f", "end": {"col": 19, "line": 45, "offset": 1514}, "start": {"col": 18, "line": 45, "offset": 1513}}, "$REQ": {"abstract_content": "request", "end": {"col": 35, "line": 39, "offset": 1228}, "start": {"col": 28, "line": 39, "offset": 1221}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/AddPage.java", "start": {"col": 18, "line": 45, "offset": 1513}}, {"check_id": "java.lang.security.audit.xss.no-direct-response-writer.no-direct-response-writer", "end": {"col": 113, "line": 55, "offset": 1952}, "extra": {"dataflow_trace": {"intermediate_vars": [{"content": "fileName", "location": {"end": {"col": 27, "line": 39, "offset": 1220}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/AddPage.java", "start": {"col": 19, "line": 39, "offset": 1212}}}], "taint_sink": ["CliLoc", [{"end": {"col": 113, "line": 55, "offset": 1952}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/AddPage.java", "start": {"col": 21, "line": 55, "offset": 1860}}, "out.print(\"Successfully created the file: <a href='../pages/\"+fileName+\"'>\"+fileName+\"</a>\")"]], "taint_source": ["CliLoc", [{"end": {"col": 60, "line": 39, "offset": 1253}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/AddPage.java", "start": {"col": 28, "line": 39, "offset": 1221}}, "request.getParameter(\"filename\")"]]}, "engine_kind": "OSS", "fingerprint": "ef36987da42cdad255b071c3f698e9286795f29ed25ab21efc806ad457571b23c422866cb022b9c05bf00d61219f0d5bc3d91e898db71171ec57834cf27b68db_0", "is_ignored": false, "lines": "                    out.print(\"Successfully created the file: <a href='../pages/\"+fileName+\"'>\"+fileName+\"</a>\");", "message": "Detected a request with potential user-input going into a OutputStream or Writer object. This bypasses any view or template environments, including HTML escaping, which may expose this application to cross-site scripting (XSS) vulnerabilities. Consider using a view technology such as JavaServer Faces (JSFs) which automatically escapes HTML views.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "interfile": true, "license": "proprietary license - copyright \u00a9 Semgrep, Inc.", "likelihood": "HIGH", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://www3.ntu.edu.sg/home/ehchua/programming/java/JavaServerFaces.html"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9211, "rule_id": "j2Uv7B", "rv_id": 904971, "url": "https://semgrep.dev/playground/r/l4TXK23/java.lang.security.audit.xss.no-direct-response-writer.no-direct-response-writer", "version_id": "l4TXK23"}}, "shortlink": "https://sg.run/KlRL", "source": "https://semgrep.dev/r/java.lang.security.audit.xss.no-direct-response-writer.no-direct-response-writer", "subcategory": ["vuln"], "technology": ["java", "servlets"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$1": {"abstract_content": "getParameter", "end": {"col": 13, "line": 1, "offset": 12}, "start": {"col": 1, "line": 1, "offset": 0}}, "$REQ": {"abstract_content": "request", "end": {"col": 35, "line": 39, "offset": 1228}, "start": {"col": 28, "line": 39, "offset": 1221}}, "$REQFUNC": {"abstract_content": "getParameter", "end": {"col": 48, "line": 39, "offset": 1241}, "start": {"col": 36, "line": 39, "offset": 1229}}, "$WRITE": {"abstract_content": "print", "end": {"col": 30, "line": 55, "offset": 1869}, "start": {"col": 25, "line": 55, "offset": 1864}}, "$WRITER": {"abstract_content": "out", "end": {"col": 24, "line": 55, "offset": 1863}, "propagated_value": {"svalue_abstract_content": "response.getWriter()", "svalue_end": {"col": 47, "line": 37, "offset": 1178}, "svalue_start": {"col": 27, "line": 37, "offset": 1158}}, "start": {"col": 21, "line": 55, "offset": 1860}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/AddPage.java", "start": {"col": 21, "line": 55, "offset": 1860}}, {"check_id": "java.lang.security.audit.sqli.tainted-sql-from-http-request.tainted-sql-from-http-request", "end": {"col": 89, "line": 48, "offset": 1759}, "extra": {"dataflow_trace": {"intermediate_vars": [{"content": "email", "location": {"end": {"col": 28, "line": 42, "offset": 1415}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/EmailCheck.java", "start": {"col": 23, "line": 42, "offset": 1410}}}], "taint_sink": ["CliLoc", [{"end": {"col": 89, "line": 48, "offset": 1759}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/EmailCheck.java", "start": {"col": 21, "line": 47, "offset": 1629}}, "Statement stmt = con.createStatement();  \n                    rs=stmt.executeQuery(\"select * from users where email='\"+email+\"'\");"]], "taint_source": ["CliLoc", [{"end": {"col": 58, "line": 42, "offset": 1445}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/EmailCheck.java", "start": {"col": 29, "line": 42, "offset": 1416}}, "request.getParameter(\"email\")"]]}, "engine_kind": "OSS", "fingerprint": "ffc35cde55a4bdaeb4c3f19b0b80c7d79e190a0304d9df35e74af3d089487de54617f25ff82efe41c11c69e83f0b52a242290035fbcadff61381230a613d27eb_0", "is_ignored": false, "lines": "                    Statement stmt = con.createStatement();  \n                    rs=stmt.executeQuery(\"select * from users where email='\"+email+\"'\");", "message": "Detected input from a HTTPServletRequest going into a SQL sink or statement. This could lead to SQL injection if variables in the SQL statement are not properly sanitized. Use parameterized SQL queries or properly sanitize user input instead.", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "HIGH", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html", "https://owasp.org/www-community/attacks/SQL_Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 18239, "rule_id": "oqUBJG", "rv_id": 833966, "url": "https://semgrep.dev/playground/r/K3TrqWq/java.lang.security.audit.sqli.tainted-sql-from-http-request.tainted-sql-from-http-request", "version_id": "K3TrqWq"}}, "shortlink": "https://sg.run/Lg56", "source": "https://semgrep.dev/r/java.lang.security.audit.sqli.tainted-sql-from-http-request.tainted-sql-from-http-request", "subcategory": ["vuln"], "technology": ["sql", "java", "servlets", "spring"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "getParameter", "end": {"col": 13, "line": 1, "offset": 12}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "executeQuery", "end": {"col": 41, "line": 48, "offset": 1711}, "start": {"col": 29, "line": 48, "offset": 1699}}, "$OUTPUT": {"abstract_content": "rs", "end": {"col": 23, "line": 48, "offset": 1693}, "start": {"col": 21, "line": 48, "offset": 1691}}, "$REQ": {"abstract_content": "request", "end": {"col": 36, "line": 42, "offset": 1423}, "start": {"col": 29, "line": 42, "offset": 1416}}, "$REQFUNC": {"abstract_content": "getParameter", "end": {"col": 49, "line": 42, "offset": 1436}, "start": {"col": 37, "line": 42, "offset": 1424}}, "$STMT": {"abstract_content": "stmt", "end": {"col": 35, "line": 47, "offset": 1643}, "start": {"col": 31, "line": 47, "offset": 1639}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/EmailCheck.java", "start": {"col": 21, "line": 47, "offset": 1629}}, {"check_id": "java.lang.security.audit.url-rewriting.url-rewriting", "end": {"col": 6, "line": 82, "offset": 3596}, "extra": {"engine_kind": "OSS", "fingerprint": "c42172279ed8c842dedb85e4c273f58fcce72d710f741732cbc2d1550188a066173e86ecf7421b5bf7489ae0c3bcc793bf95a6f298f98fe8609a35f5a2dab9ca_0", "is_ignored": false, "lines": "    protected void processRequest(HttpServletRequest request, HttpServletResponse response)\n            throws ServletException, IOException {\n        \n       \n       String user=request.getParameter(\"username\").trim();\n          String pass=request.getParameter(\"password\").trim();\n           try\n             {\n                 Connection con=new DBConnect().connect(getServletContext().getRealPath(\"/WEB-INF/config.properties\"));\n                    if(con!=null && !con.isClosed())\n                               {\n                                   ResultSet rs=null;\n                                   Statement stmt = con.createStatement();  \n                                   rs=stmt.executeQuery(\"select * from users where username='\"+user+\"' and password='\"+pass+\"'\");\n                                   if(rs != null && rs.next()){\n                                   HttpSession session=request.getSession();\n                                   session.setAttribute(\"isLoggedIn\", \"1\");\n                                   session.setAttribute(\"userid\", rs.getString(\"id\"));\n                                   session.setAttribute(\"user\", rs.getString(\"username\"));\n                                   session.setAttribute(\"avatar\", rs.getString(\"avatar\"));\n                                   Cookie privilege=new Cookie(\"privilege\",\"user\");\n                                   response.addCookie(privilege);\n                                   if(request.getParameter(\"RememberMe\")!=null)\n                                   {\n                                       Cookie username=new Cookie(\"username\",user);\n                                       Cookie password=new Cookie(\"password\",pass);\n                                       response.addCookie(username);\n                                        response.addCookie(password);\n                                   }\n                                   response.sendRedirect(response.encodeURL(\"ForwardMe?location=/index.jsp\"));\n                                   }\n                                   else\n                                   {\n                                          response.sendRedirect(\"ForwardMe?location=/login.jsp&err=Invalid Username or Password\");\n                                   }\n                                    \n                               }\n                }\n               catch(Exception ex)\n                {\n                           response.sendRedirect(\"login.jsp?err=something went wrong\");\n                 }\n        \n    }", "message": "URL rewriting has significant security risks. Since session ID appears in the URL, it may be easily seen by third parties.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-200: Exposure of Sensitive Information to an Unauthorized Actor"], "cwe2021-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2021 - Broken Access Control"], "references": ["https://owasp.org/Top10/A01_2021-Broken_Access_Control"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9187, "rule_id": "0oU5j3", "rv_id": 833976, "url": "https://semgrep.dev/playground/r/jQTrXXk/java.lang.security.audit.url-rewriting.url-rewriting", "version_id": "jQTrXXk"}}, "shortlink": "https://sg.run/3x7b", "source": "https://semgrep.dev/r/java.lang.security.audit.url-rewriting.url-rewriting", "source-rule-url": "https://find-sec-bugs.github.io/bugs.htm#URL_REWRITING", "subcategory": ["vuln"], "technology": ["java"], "vulnerability_class": ["Mishandled Sensitive Information"]}, "metavars": {"$METHOD": {"abstract_content": "processRequest", "end": {"col": 34, "line": 39, "offset": 1097}, "start": {"col": 20, "line": 39, "offset": 1083}}, "$RES": {"abstract_content": "response", "end": {"col": 91, "line": 39, "offset": 1154}, "start": {"col": 83, "line": 39, "offset": 1146}}, "$X": {"abstract_content": "void", "end": {"col": 19, "line": 39, "offset": 1082}, "start": {"col": 15, "line": 39, "offset": 1078}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/LoginValidator.java", "start": {"col": 5, "line": 39, "offset": 1068}}, {"check_id": "java.lang.security.audit.sqli.tainted-sql-from-http-request.tainted-sql-from-http-request", "end": {"col": 130, "line": 52, "offset": 1843}, "extra": {"dataflow_trace": {"intermediate_vars": [{"content": "user", "location": {"end": {"col": 19, "line": 43, "offset": 1242}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/LoginValidator.java", "start": {"col": 15, "line": 43, "offset": 1238}}}], "taint_sink": ["CliLoc", [{"end": {"col": 130, "line": 52, "offset": 1843}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/LoginValidator.java", "start": {"col": 36, "line": 51, "offset": 1672}}, "Statement stmt = con.createStatement();  \n                                   rs=stmt.executeQuery(\"select * from users where username='\"+user+\"' and password='\"+pass+\"'\");"]], "taint_source": ["CliLoc", [{"end": {"col": 52, "line": 43, "offset": 1275}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/LoginValidator.java", "start": {"col": 20, "line": 43, "offset": 1243}}, "request.getParameter(\"username\")"]]}, "engine_kind": "OSS", "fingerprint": "f0b16c461d0a35360ba1e0fa1a2e7e3d041b58e3587f76a71457a60221920ba13b3dc7330765276d235cf25a1893e2d479aa711627116046df537f5ee6479ec7_0", "is_ignored": false, "lines": "                                   Statement stmt = con.createStatement();  \n                                   rs=stmt.executeQuery(\"select * from users where username='\"+user+\"' and password='\"+pass+\"'\");", "message": "Detected input from a HTTPServletRequest going into a SQL sink or statement. This could lead to SQL injection if variables in the SQL statement are not properly sanitized. Use parameterized SQL queries or properly sanitize user input instead.", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "HIGH", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html", "https://owasp.org/www-community/attacks/SQL_Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 18239, "rule_id": "oqUBJG", "rv_id": 833966, "url": "https://semgrep.dev/playground/r/K3TrqWq/java.lang.security.audit.sqli.tainted-sql-from-http-request.tainted-sql-from-http-request", "version_id": "K3TrqWq"}}, "shortlink": "https://sg.run/Lg56", "source": "https://semgrep.dev/r/java.lang.security.audit.sqli.tainted-sql-from-http-request.tainted-sql-from-http-request", "subcategory": ["vuln"], "technology": ["sql", "java", "servlets", "spring"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "getParameter", "end": {"col": 13, "line": 1, "offset": 12}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "executeQuery", "end": {"col": 56, "line": 52, "offset": 1769}, "start": {"col": 44, "line": 52, "offset": 1757}}, "$OUTPUT": {"abstract_content": "rs", "end": {"col": 38, "line": 52, "offset": 1751}, "start": {"col": 36, "line": 52, "offset": 1749}}, "$REQ": {"abstract_content": "request", "end": {"col": 27, "line": 43, "offset": 1250}, "start": {"col": 20, "line": 43, "offset": 1243}}, "$REQFUNC": {"abstract_content": "getParameter", "end": {"col": 40, "line": 43, "offset": 1263}, "start": {"col": 28, "line": 43, "offset": 1251}}, "$STMT": {"abstract_content": "stmt", "end": {"col": 50, "line": 51, "offset": 1686}, "start": {"col": 46, "line": 51, "offset": 1682}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/LoginValidator.java", "start": {"col": 36, "line": 51, "offset": 1672}}, {"check_id": "java.lang.security.audit.cookie-missing-httponly.cookie-missing-httponly", "end": {"col": 66, "line": 60, "offset": 2479}, "extra": {"engine_kind": "OSS", "fingerprint": "5bffc7dd026c59157fc19964b9e5d898879b4e96665a7aa2b288b8f6a967ef88e117eb7ca84aabea4aba9d5185f74e5615a70bf8c7b91c2f2285e78081763066_0", "is_ignored": false, "lines": "                                   response.addCookie(privilege);", "message": "A cookie was detected without setting the 'HttpOnly' flag. The 'HttpOnly' flag for cookies instructs the browser to forbid client-side scripts from reading the cookie. Set the 'HttpOnly' flag by calling 'cookie.setHttpOnly(true);'", "metadata": {"asvs": {"control_id": "3.4.2 Missing Cookie Attribute", "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V3-Session-management.md#v34-cookie-based-session-management", "section": "V3: Session Management Verification Requirements", "version": "4"}, "category": "security", "confidence": "LOW", "cwe": ["CWE-1004: Sensitive Cookie Without 'HttpOnly' Flag"], "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration"], "references": ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9170, "rule_id": "EwU2z6", "rv_id": 833921, "url": "https://semgrep.dev/playground/r/9lTJ0xP/java.lang.security.audit.cookie-missing-httponly.cookie-missing-httponly", "version_id": "9lTJ0xP"}}, "shortlink": "https://sg.run/b7Be", "source": "https://semgrep.dev/r/java.lang.security.audit.cookie-missing-httponly.cookie-missing-httponly", "source-rule-url": "https://find-sec-bugs.github.io/bugs.htm#HTTPONLY_COOKIE", "subcategory": ["audit"], "technology": ["java"], "vulnerability_class": ["Cookie Security"]}, "metavars": {"$COOKIE": {"abstract_content": "privilege", "end": {"col": 64, "line": 60, "offset": 2477}, "propagated_value": {"svalue_abstract_content": "new Cookie(\"privilege\"\"user\")", "svalue_end": {"col": 83, "line": 59, "offset": 2412}, "svalue_start": {"col": 53, "line": 59, "offset": 2382}}, "start": {"col": 55, "line": 60, "offset": 2468}}, "$RESPONSE": {"abstract_content": "response", "end": {"col": 44, "line": 60, "offset": 2457}, "start": {"col": 36, "line": 60, "offset": 2449}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/LoginValidator.java", "start": {"col": 36, "line": 60, "offset": 2449}}, {"check_id": "java.lang.security.audit.cookie-missing-secure-flag.cookie-missing-secure-flag", "end": {"col": 66, "line": 60, "offset": 2479}, "extra": {"engine_kind": "OSS", "fingerprint": "4f5fab8d3191f83241325026dde342f05507fa7c116e74aebed0dea3e9ea6c6e96f3e7ca35bd49e75f81b518c670a68a806917598f6bca37df56b09e99085d07_0", "is_ignored": false, "lines": "                                   response.addCookie(privilege);", "message": "A cookie was detected without setting the 'secure' flag. The 'secure' flag for cookies prevents the client from transmitting the cookie over insecure channels such as HTTP. Set the 'secure' flag by calling 'privilege.setSecure(true);'", "metadata": {"asvs": {"control_id": "3.4.1 Missing Cookie Attribute", "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V3-Session-management.md#v34-cookie-based-session-management", "section": "V3: Session Management Verification Requirements", "version": "4"}, "category": "security", "confidence": "LOW", "cwe": ["CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute"], "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration"], "references": ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9172, "rule_id": "L1Uyvp", "rv_id": 833922, "url": "https://semgrep.dev/playground/r/yeTN1K1/java.lang.security.audit.cookie-missing-secure-flag.cookie-missing-secure-flag", "version_id": "yeTN1K1"}}, "shortlink": "https://sg.run/kXoK", "source": "https://semgrep.dev/r/java.lang.security.audit.cookie-missing-secure-flag.cookie-missing-secure-flag", "source-rule-url": "https://find-sec-bugs.github.io/bugs.htm#INSECURE_COOKIE", "subcategory": ["audit"], "technology": ["java"], "vulnerability_class": ["Cookie Security"]}, "metavars": {"$COOKIE": {"abstract_content": "privilege", "end": {"col": 64, "line": 60, "offset": 2477}, "propagated_value": {"svalue_abstract_content": "new Cookie(\"privilege\"\"user\")", "svalue_end": {"col": 83, "line": 59, "offset": 2412}, "svalue_start": {"col": 53, "line": 59, "offset": 2382}}, "start": {"col": 55, "line": 60, "offset": 2468}}, "$RESPONSE": {"abstract_content": "response", "end": {"col": 44, "line": 60, "offset": 2457}, "start": {"col": 36, "line": 60, "offset": 2449}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/LoginValidator.java", "start": {"col": 36, "line": 60, "offset": 2449}}, {"check_id": "java.lang.security.audit.cookie-missing-httponly.cookie-missing-httponly", "end": {"col": 69, "line": 65, "offset": 2833}, "extra": {"engine_kind": "OSS", "fingerprint": "4a33aba1c030107f61d274b3bd04e5bba9feceef51d3bb0bda2ce1483a8cae5e7129cef578724e22080b215d30534548244ba0f587ad85fc8ba4aa4a1f4de587_0", "is_ignored": false, "lines": "                                       response.addCookie(username);", "message": "A cookie was detected without setting the 'HttpOnly' flag. The 'HttpOnly' flag for cookies instructs the browser to forbid client-side scripts from reading the cookie. Set the 'HttpOnly' flag by calling 'cookie.setHttpOnly(true);'", "metadata": {"asvs": {"control_id": "3.4.2 Missing Cookie Attribute", "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V3-Session-management.md#v34-cookie-based-session-management", "section": "V3: Session Management Verification Requirements", "version": "4"}, "category": "security", "confidence": "LOW", "cwe": ["CWE-1004: Sensitive Cookie Without 'HttpOnly' Flag"], "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration"], "references": ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9170, "rule_id": "EwU2z6", "rv_id": 833921, "url": "https://semgrep.dev/playground/r/9lTJ0xP/java.lang.security.audit.cookie-missing-httponly.cookie-missing-httponly", "version_id": "9lTJ0xP"}}, "shortlink": "https://sg.run/b7Be", "source": "https://semgrep.dev/r/java.lang.security.audit.cookie-missing-httponly.cookie-missing-httponly", "source-rule-url": "https://find-sec-bugs.github.io/bugs.htm#HTTPONLY_COOKIE", "subcategory": ["audit"], "technology": ["java"], "vulnerability_class": ["Cookie Security"]}, "metavars": {"$COOKIE": {"abstract_content": "username", "end": {"col": 67, "line": 65, "offset": 2831}, "propagated_value": {"svalue_abstract_content": "new Cookie(\"username\"user)", "svalue_end": {"col": 83, "line": 63, "offset": 2679}, "svalue_start": {"col": 56, "line": 63, "offset": 2652}}, "start": {"col": 59, "line": 65, "offset": 2823}}, "$RESPONSE": {"abstract_content": "response", "end": {"col": 48, "line": 65, "offset": 2812}, "start": {"col": 40, "line": 65, "offset": 2804}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/LoginValidator.java", "start": {"col": 40, "line": 65, "offset": 2804}}, {"check_id": "java.lang.security.audit.cookie-missing-secure-flag.cookie-missing-secure-flag", "end": {"col": 69, "line": 65, "offset": 2833}, "extra": {"engine_kind": "OSS", "fingerprint": "dfa7d3e1e8c968a109345dfcb897f264f717081b9417cdd3af053e6618aa520bc4fb8f4dc4420ddcdb9d0b65a6df764d684375eaa37f2a791a387fa0895c5133_0", "is_ignored": false, "lines": "                                       response.addCookie(username);", "message": "A cookie was detected without setting the 'secure' flag. The 'secure' flag for cookies prevents the client from transmitting the cookie over insecure channels such as HTTP. Set the 'secure' flag by calling 'username.setSecure(true);'", "metadata": {"asvs": {"control_id": "3.4.1 Missing Cookie Attribute", "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V3-Session-management.md#v34-cookie-based-session-management", "section": "V3: Session Management Verification Requirements", "version": "4"}, "category": "security", "confidence": "LOW", "cwe": ["CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute"], "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration"], "references": ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9172, "rule_id": "L1Uyvp", "rv_id": 833922, "url": "https://semgrep.dev/playground/r/yeTN1K1/java.lang.security.audit.cookie-missing-secure-flag.cookie-missing-secure-flag", "version_id": "yeTN1K1"}}, "shortlink": "https://sg.run/kXoK", "source": "https://semgrep.dev/r/java.lang.security.audit.cookie-missing-secure-flag.cookie-missing-secure-flag", "source-rule-url": "https://find-sec-bugs.github.io/bugs.htm#INSECURE_COOKIE", "subcategory": ["audit"], "technology": ["java"], "vulnerability_class": ["Cookie Security"]}, "metavars": {"$COOKIE": {"abstract_content": "username", "end": {"col": 67, "line": 65, "offset": 2831}, "propagated_value": {"svalue_abstract_content": "new Cookie(\"username\"user)", "svalue_end": {"col": 83, "line": 63, "offset": 2679}, "svalue_start": {"col": 56, "line": 63, "offset": 2652}}, "start": {"col": 59, "line": 65, "offset": 2823}}, "$RESPONSE": {"abstract_content": "response", "end": {"col": 48, "line": 65, "offset": 2812}, "start": {"col": 40, "line": 65, "offset": 2804}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/LoginValidator.java", "start": {"col": 40, "line": 65, "offset": 2804}}, {"check_id": "java.lang.security.audit.cookie-missing-httponly.cookie-missing-httponly", "end": {"col": 70, "line": 66, "offset": 2903}, "extra": {"engine_kind": "OSS", "fingerprint": "edfc34ab60fb4ee7f2f0cbabdd38397d1544a66fb2110bf3d6fbaf4b66b17ac5f95716a3ed53f87bc0fd7c7d0a741d57a7cb9522b85cfca54756dd417a8e73df_0", "is_ignored": false, "lines": "                                        response.addCookie(password);", "message": "A cookie was detected without setting the 'HttpOnly' flag. The 'HttpOnly' flag for cookies instructs the browser to forbid client-side scripts from reading the cookie. Set the 'HttpOnly' flag by calling 'cookie.setHttpOnly(true);'", "metadata": {"asvs": {"control_id": "3.4.2 Missing Cookie Attribute", "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V3-Session-management.md#v34-cookie-based-session-management", "section": "V3: Session Management Verification Requirements", "version": "4"}, "category": "security", "confidence": "LOW", "cwe": ["CWE-1004: Sensitive Cookie Without 'HttpOnly' Flag"], "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration"], "references": ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9170, "rule_id": "EwU2z6", "rv_id": 833921, "url": "https://semgrep.dev/playground/r/9lTJ0xP/java.lang.security.audit.cookie-missing-httponly.cookie-missing-httponly", "version_id": "9lTJ0xP"}}, "shortlink": "https://sg.run/b7Be", "source": "https://semgrep.dev/r/java.lang.security.audit.cookie-missing-httponly.cookie-missing-httponly", "source-rule-url": "https://find-sec-bugs.github.io/bugs.htm#HTTPONLY_COOKIE", "subcategory": ["audit"], "technology": ["java"], "vulnerability_class": ["Cookie Security"]}, "metavars": {"$COOKIE": {"abstract_content": "password", "end": {"col": 68, "line": 66, "offset": 2901}, "propagated_value": {"svalue_abstract_content": "new Cookie(\"password\"pass)", "svalue_end": {"col": 83, "line": 64, "offset": 2763}, "svalue_start": {"col": 56, "line": 64, "offset": 2736}}, "start": {"col": 60, "line": 66, "offset": 2893}}, "$RESPONSE": {"abstract_content": "response", "end": {"col": 49, "line": 66, "offset": 2882}, "start": {"col": 41, "line": 66, "offset": 2874}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/LoginValidator.java", "start": {"col": 41, "line": 66, "offset": 2874}}, {"check_id": "java.lang.security.audit.cookie-missing-secure-flag.cookie-missing-secure-flag", "end": {"col": 70, "line": 66, "offset": 2903}, "extra": {"engine_kind": "OSS", "fingerprint": "e7546218d9049605b2f3db4a745ae6fa62e4895aa2ba5c5af26667886c9301f5184faf34499578d00a1048980190a5b842e5abb2a5fe9fcfb0d9958f32ddff20_0", "is_ignored": false, "lines": "                                        response.addCookie(password);", "message": "A cookie was detected without setting the 'secure' flag. The 'secure' flag for cookies prevents the client from transmitting the cookie over insecure channels such as HTTP. Set the 'secure' flag by calling 'password.setSecure(true);'", "metadata": {"asvs": {"control_id": "3.4.1 Missing Cookie Attribute", "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V3-Session-management.md#v34-cookie-based-session-management", "section": "V3: Session Management Verification Requirements", "version": "4"}, "category": "security", "confidence": "LOW", "cwe": ["CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute"], "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration"], "references": ["https://owasp.org/Top10/A05_2021-Security_Misconfiguration"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9172, "rule_id": "L1Uyvp", "rv_id": 833922, "url": "https://semgrep.dev/playground/r/yeTN1K1/java.lang.security.audit.cookie-missing-secure-flag.cookie-missing-secure-flag", "version_id": "yeTN1K1"}}, "shortlink": "https://sg.run/kXoK", "source": "https://semgrep.dev/r/java.lang.security.audit.cookie-missing-secure-flag.cookie-missing-secure-flag", "source-rule-url": "https://find-sec-bugs.github.io/bugs.htm#INSECURE_COOKIE", "subcategory": ["audit"], "technology": ["java"], "vulnerability_class": ["Cookie Security"]}, "metavars": {"$COOKIE": {"abstract_content": "password", "end": {"col": 68, "line": 66, "offset": 2901}, "propagated_value": {"svalue_abstract_content": "new Cookie(\"password\"pass)", "svalue_end": {"col": 83, "line": 64, "offset": 2763}, "svalue_start": {"col": 56, "line": 64, "offset": 2736}}, "start": {"col": 60, "line": 66, "offset": 2893}}, "$RESPONSE": {"abstract_content": "response", "end": {"col": 49, "line": 66, "offset": 2882}, "start": {"col": 41, "line": 66, "offset": 2874}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/LoginValidator.java", "start": {"col": 41, "line": 66, "offset": 2874}}, {"check_id": "java.lang.security.audit.unvalidated-redirect.unvalidated-redirect", "end": {"col": 6, "line": 50, "offset": 1433}, "extra": {"engine_kind": "OSS", "fingerprint": "0334c52ff54a0f553686431de7442a044794ede8b5c66ba07be682770ae015f8a873b6649fcfefcbc286b63b8db4d6420aa1dee9d8c374a20351c5d85ed6c76b_0", "is_ignored": false, "lines": "    protected void processRequest(HttpServletRequest request, HttpServletResponse response)\n            throws ServletException, IOException {\n        response.setContentType(\"text/html;charset=UTF-8\");\n         try {\n            PrintWriter out = response.getWriter();\n           String url=request.getParameter(\"url\");\n           if(url!=null)\n           {\n              response.sendRedirect(url);\n           }\n           else\n           {\n               out.print(\"Missing url parameter\");\n           }\n        }\n         catch(Exception e)\n         {\n             \n         }\n    }", "message": "Application redirects to a destination URL specified by a user-supplied parameter that is not validated. This could direct users to malicious locations. Consider using an allowlist to validate URLs.", "metadata": {"asvs": {"control_id": "5.1.5 Open Redirect", "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v51-input-validation-requirements", "section": "V5: Validation, Sanitization and Encoding Verification Requirements", "version": "4"}, "category": "security", "confidence": "MEDIUM", "cwe": ["CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"], "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A01:2021 - Broken Access Control"], "references": ["https://owasp.org/Top10/A01_2021-Broken_Access_Control"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9186, "rule_id": "WAUo0p", "rv_id": 833975, "url": "https://semgrep.dev/playground/r/X0T5N6B/java.lang.security.audit.unvalidated-redirect.unvalidated-redirect", "version_id": "X0T5N6B"}}, "shortlink": "https://sg.run/Q51P", "source": "https://semgrep.dev/r/java.lang.security.audit.unvalidated-redirect.unvalidated-redirect", "source-rule-url": "https://find-sec-bugs.github.io/bugs.htm#UNVALIDATED_REDIRECT", "subcategory": ["vuln"], "technology": ["java"], "vulnerability_class": ["Open Redirect"]}, "metavars": {"$METHOD": {"abstract_content": "processRequest", "end": {"col": 34, "line": 31, "offset": 880}, "start": {"col": 20, "line": 31, "offset": 866}}, "$REQ": {"abstract_content": "request", "end": {"col": 61, "line": 31, "offset": 907}, "start": {"col": 54, "line": 31, "offset": 900}}, "$RES": {"abstract_content": "response", "end": {"col": 91, "line": 31, "offset": 937}, "start": {"col": 83, "line": 31, "offset": 929}}, "$URL": {"abstract_content": "url", "end": {"col": 22, "line": 36, "offset": 1138}, "start": {"col": 19, "line": 36, "offset": 1135}}, "$X": {"abstract_content": "void", "end": {"col": 19, "line": 31, "offset": 865}, "start": {"col": 15, "line": 31, "offset": 861}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/Open.java", "start": {"col": 5, "line": 31, "offset": 851}}, {"check_id": "java.lang.security.audit.sqli.tainted-sql-from-http-request.tainted-sql-from-http-request", "end": {"col": 91, "line": 48, "offset": 1766}, "extra": {"dataflow_trace": {"intermediate_vars": [{"content": "user", "location": {"end": {"col": 27, "line": 42, "offset": 1417}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/UsernameCheck.java", "start": {"col": 23, "line": 42, "offset": 1413}}}], "taint_sink": ["CliLoc", [{"end": {"col": 91, "line": 48, "offset": 1766}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/UsernameCheck.java", "start": {"col": 21, "line": 47, "offset": 1634}}, "Statement stmt = con.createStatement();  \n                    rs=stmt.executeQuery(\"select * from users where username='\"+user+\"'\");"]], "taint_source": ["CliLoc", [{"end": {"col": 60, "line": 42, "offset": 1450}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/UsernameCheck.java", "start": {"col": 28, "line": 42, "offset": 1418}}, "request.getParameter(\"username\")"]]}, "engine_kind": "OSS", "fingerprint": "ab4d97d0bb2e83da1f7fffb4175c813f3513eab7d42d9da4db139d845c32be0c854e24a2d0a2999635a493c14f9bc103ccbcfcd8892cd095afde502655d882b4_0", "is_ignored": false, "lines": "                    Statement stmt = con.createStatement();  \n                    rs=stmt.executeQuery(\"select * from users where username='\"+user+\"'\");", "message": "Detected input from a HTTPServletRequest going into a SQL sink or statement. This could lead to SQL injection if variables in the SQL statement are not properly sanitized. Use parameterized SQL queries or properly sanitize user input instead.", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "HIGH", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html", "https://owasp.org/www-community/attacks/SQL_Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 18239, "rule_id": "oqUBJG", "rv_id": 833966, "url": "https://semgrep.dev/playground/r/K3TrqWq/java.lang.security.audit.sqli.tainted-sql-from-http-request.tainted-sql-from-http-request", "version_id": "K3TrqWq"}}, "shortlink": "https://sg.run/Lg56", "source": "https://semgrep.dev/r/java.lang.security.audit.sqli.tainted-sql-from-http-request.tainted-sql-from-http-request", "subcategory": ["vuln"], "technology": ["sql", "java", "servlets", "spring"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "getParameter", "end": {"col": 13, "line": 1, "offset": 12}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "executeQuery", "end": {"col": 41, "line": 48, "offset": 1716}, "start": {"col": 29, "line": 48, "offset": 1704}}, "$OUTPUT": {"abstract_content": "rs", "end": {"col": 23, "line": 48, "offset": 1698}, "start": {"col": 21, "line": 48, "offset": 1696}}, "$REQ": {"abstract_content": "request", "end": {"col": 35, "line": 42, "offset": 1425}, "start": {"col": 28, "line": 42, "offset": 1418}}, "$REQFUNC": {"abstract_content": "getParameter", "end": {"col": 48, "line": 42, "offset": 1438}, "start": {"col": 36, "line": 42, "offset": 1426}}, "$STMT": {"abstract_content": "stmt", "end": {"col": 35, "line": 47, "offset": 1648}, "start": {"col": 31, "line": 47, "offset": 1644}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/UsernameCheck.java", "start": {"col": 21, "line": 47, "offset": 1634}}, {"check_id": "java.lang.security.audit.url-rewriting.url-rewriting", "end": {"col": 6, "line": 74, "offset": 2622}, "extra": {"engine_kind": "OSS", "fingerprint": "0bce44bfbdd091c73f8e98f2f1e199b1664ca40744e697d14bcaf2c3f1c0c21cc8861c44ffd6b15293d3ffc81241b3e1fc2745233d210bab69c8b071891b6b0c_0", "is_ignored": false, "lines": "    protected void processRequest(HttpServletRequest request, HttpServletResponse response)\n            throws ServletException, IOException {\n        response.setContentType(\"text/html;charset=UTF-8\");\n        PrintWriter out = response.getWriter();\n        try {\n            String user=request.getParameter(\"username\");\n            String pass=request.getParameter(\"password\");\n            \n            //XML Source:\n            String XML_SOURCE=getServletContext().getRealPath(\"/WEB-INF/users.xml\");\n            \n            //Parsing XML:\n            DocumentBuilderFactory factory=DocumentBuilderFactory.newInstance();\n            factory.setNamespaceAware(true);\n            DocumentBuilder builder=factory.newDocumentBuilder();\n            Document xDoc=builder.parse(XML_SOURCE);\n            \n            XPath xPath=XPathFactory.newInstance().newXPath();\n            \n            //XPath Query:\n            String xPression=\"/users/user[username='\"+user+\"' and password='\"+pass+\"']/name\";\n            \n            //running Xpath query:\n            String name=xPath.compile(xPression).evaluate(xDoc);\n            out.println(name);\n            if(name.isEmpty())\n            {\n                response.sendRedirect(response.encodeURL(\"ForwardMe?location=/vulnerability/Injection/xpath_login.jsp?err=Invalid Credentials\"));\n            }\n            else\n            {\n                 HttpSession session=request.getSession();\n                 session.setAttribute(\"isLoggedIn\", \"1\");\n                  session.setAttribute(\"user\", name);\n                 response.sendRedirect(response.encodeURL(\"ForwardMe?location=/index.jsp\"));                                  \n            }\n        } \n        catch(Exception e)\n        {\n            out.print(e);\n        }        \n        finally {\n            out.close();\n        }\n    }", "message": "URL rewriting has significant security risks. Since session ID appears in the URL, it may be easily seen by third parties.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-200: Exposure of Sensitive Information to an Unauthorized Actor"], "cwe2021-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2021 - Broken Access Control"], "references": ["https://owasp.org/Top10/A01_2021-Broken_Access_Control"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9187, "rule_id": "0oU5j3", "rv_id": 833976, "url": "https://semgrep.dev/playground/r/jQTrXXk/java.lang.security.audit.url-rewriting.url-rewriting", "version_id": "jQTrXXk"}}, "shortlink": "https://sg.run/3x7b", "source": "https://semgrep.dev/r/java.lang.security.audit.url-rewriting.url-rewriting", "source-rule-url": "https://find-sec-bugs.github.io/bugs.htm#URL_REWRITING", "subcategory": ["vuln"], "technology": ["java"], "vulnerability_class": ["Mishandled Sensitive Information"]}, "metavars": {"$METHOD": {"abstract_content": "processRequest", "end": {"col": 34, "line": 30, "offset": 813}, "start": {"col": 20, "line": 30, "offset": 799}}, "$RES": {"abstract_content": "response", "end": {"col": 91, "line": 30, "offset": 870}, "start": {"col": 83, "line": 30, "offset": 862}}, "$X": {"abstract_content": "void", "end": {"col": 19, "line": 30, "offset": 798}, "start": {"col": 15, "line": 30, "offset": 794}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/XPathQuery.java", "start": {"col": 5, "line": 30, "offset": 784}}, {"check_id": "java.lang.security.audit.xxe.documentbuilderfactory-disallow-doctype-decl-missing.documentbuilderfactory-disallow-doctype-decl-missing", "end": {"col": 66, "line": 44, "offset": 1516}, "extra": {"dataflow_trace": {"intermediate_vars": [{"content": "factory", "location": {"end": {"col": 43, "line": 42, "offset": 1367}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/XPathQuery.java", "start": {"col": 36, "line": 42, "offset": 1360}}}], "taint_sink": ["CliLoc", [{"end": {"col": 66, "line": 44, "offset": 1516}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/XPathQuery.java", "start": {"col": 13, "line": 44, "offset": 1463}}, "DocumentBuilder builder=factory.newDocumentBuilder();"]], "taint_source": ["CliLoc", [{"end": {"col": 81, "line": 42, "offset": 1405}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/XPathQuery.java", "start": {"col": 13, "line": 42, "offset": 1337}}, "DocumentBuilderFactory factory=DocumentBuilderFactory.newInstance();"]]}, "engine_kind": "OSS", "fingerprint": "74f3f18eade8386ca19a20328ef33602b6e4d5ee6c8bfc81c88df625acd2daabafc75d2f04a3fb015181c6a2e7752314e12a560ade1598fb9622a8e963cc316e_0", "fix": "factory.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", true);\n            factory.newDocumentBuilder();", "is_ignored": false, "lines": "            DocumentBuilder builder=factory.newDocumentBuilder();", "message": "DOCTYPE declarations are enabled for this DocumentBuilderFactory. This is vulnerable to XML external entity attacks. Disable this by setting the feature \"http://apache.org/xml/features/disallow-doctype-decl\" to true. Alternatively, allow DOCTYPE declarations and only prohibit external entities declarations. This can be done by setting the features \"http://xml.org/sax/features/external-general-entities\" and \"http://xml.org/sax/features/external-parameter-entities\" to false.", "metadata": {"asvs": {"control_id": "5.5.2 Insecue XML Deserialization", "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v55-deserialization-prevention", "section": "V5 Validation, Sanitization and Encoding", "version": "4"}, "category": "security", "confidence": "HIGH", "cwe": ["CWE-611: Improper Restriction of XML External Entity Reference"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A04:2017 - XML External Entities (XXE)", "A05:2021 - Security Misconfiguration"], "references": ["https://semgrep.dev/blog/2022/xml-security-in-java", "https://semgrep.dev/docs/cheat-sheets/java-xxe/", "https://blog.sonarsource.com/secure-xml-processor", "https://xerces.apache.org/xerces2-j/features.html"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 18245, "rule_id": "10UPQB", "rv_id": 833986, "url": "https://semgrep.dev/playground/r/O9TJWWv/java.lang.security.audit.xxe.documentbuilderfactory-disallow-doctype-decl-missing.documentbuilderfactory-disallow-doctype-decl-missing", "version_id": "O9TJWWv"}}, "shortlink": "https://sg.run/PYBz", "source": "https://semgrep.dev/r/java.lang.security.audit.xxe.documentbuilderfactory-disallow-doctype-decl-missing.documentbuilderfactory-disallow-doctype-decl-missing", "subcategory": ["vuln"], "technology": ["java", "xml"], "vulnerability_class": ["XML Injection"]}, "metavars": {"$FACTORY": {"abstract_content": "factory", "end": {"col": 43, "line": 42, "offset": 1367}, "start": {"col": 36, "line": 42, "offset": 1360}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/XPathQuery.java", "start": {"col": 13, "line": 44, "offset": 1463}}, {"check_id": "java.lang.security.audit.tainted-xpath-from-http-request.tainted-xpath-from-http-request", "end": {"col": 64, "line": 53, "offset": 1891}, "extra": {"dataflow_trace": {"intermediate_vars": [{"content": "user", "location": {"end": {"col": 24, "line": 35, "offset": 1068}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/XPathQuery.java", "start": {"col": 20, "line": 35, "offset": 1064}}}, {"content": "xPression", "location": {"end": {"col": 29, "line": 50, "offset": 1714}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/XPathQuery.java", "start": {"col": 20, "line": 50, "offset": 1705}}}], "taint_sink": ["CliLoc", [{"end": {"col": 64, "line": 53, "offset": 1891}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/XPathQuery.java", "start": {"col": 25, "line": 53, "offset": 1852}}, "xPath.compile(xPression).evaluate(xDoc)"]], "taint_source": ["CliLoc", [{"end": {"col": 57, "line": 35, "offset": 1101}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/XPathQuery.java", "start": {"col": 25, "line": 35, "offset": 1069}}, "request.getParameter(\"username\")"]]}, "engine_kind": "OSS", "fingerprint": "e0b1e1bd312508e7c5a60a0f0b782210bafa4aff6abd932f3cd23f8edca006c0598a1fcf7aa1ee6c9454818c10d1c169561d8b1ff455338d865da7141ad92aba_0", "is_ignored": false, "lines": "            String name=xPath.compile(xPression).evaluate(xDoc);", "message": "Detected input from a HTTPServletRequest going into a XPath evaluate or compile command. This could lead to xpath injection if variables passed into the evaluate or compile commands are not properly sanitized. Xpath injection could lead to unauthorized access to sensitive information in XML documents. Instead, thoroughly sanitize user input or use parameterized xpath queries if you can.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-643: Improper Neutralization of Data within XPath Expressions ('XPath Injection')"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "HIGH", "owasp": ["A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 18243, "rule_id": "X5U5nj", "rv_id": 833973, "url": "https://semgrep.dev/playground/r/pZTXj7r/java.lang.security.audit.tainted-xpath-from-http-request.tainted-xpath-from-http-request", "version_id": "pZTXj7r"}}, "shortlink": "https://sg.run/3BvK", "source": "https://semgrep.dev/r/java.lang.security.audit.tainted-xpath-from-http-request.tainted-xpath-from-http-request", "subcategory": ["vuln"], "technology": ["java"], "vulnerability_class": ["XPath Injection"]}, "metavars": {"$FUNC": {"abstract_content": "getParameter", "end": {"col": 45, "line": 35, "offset": 1089}, "start": {"col": 33, "line": 35, "offset": 1077}}, "$REQ": {"abstract_content": "request", "end": {"col": 32, "line": 35, "offset": 1076}, "start": {"col": 25, "line": 35, "offset": 1069}}, "$XP": {"abstract_content": "xPath", "end": {"col": 30, "line": 53, "offset": 1857}, "propagated_value": {"svalue_abstract_content": "XPathFactory.newInstance().newXPath()", "svalue_end": {"col": 62, "line": 47, "offset": 1644}, "svalue_start": {"col": 25, "line": 47, "offset": 1607}}, "start": {"col": 25, "line": 53, "offset": 1852}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/XPathQuery.java", "start": {"col": 25, "line": 53, "offset": 1852}}, {"check_id": "java.lang.security.audit.xss.no-direct-response-writer.no-direct-response-writer", "end": {"col": 30, "line": 54, "offset": 1922}, "extra": {"dataflow_trace": {"intermediate_vars": [{"content": "user", "location": {"end": {"col": 24, "line": 35, "offset": 1068}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/XPathQuery.java", "start": {"col": 20, "line": 35, "offset": 1064}}}, {"content": "xPression", "location": {"end": {"col": 29, "line": 50, "offset": 1714}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/XPathQuery.java", "start": {"col": 20, "line": 50, "offset": 1705}}}, {"content": "name", "location": {"end": {"col": 24, "line": 53, "offset": 1851}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/XPathQuery.java", "start": {"col": 20, "line": 53, "offset": 1847}}}], "taint_sink": ["CliLoc", [{"end": {"col": 30, "line": 54, "offset": 1922}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/XPathQuery.java", "start": {"col": 13, "line": 54, "offset": 1905}}, "out.println(name)"]], "taint_source": ["CliLoc", [{"end": {"col": 57, "line": 35, "offset": 1101}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/XPathQuery.java", "start": {"col": 25, "line": 35, "offset": 1069}}, "request.getParameter(\"username\")"]]}, "engine_kind": "OSS", "fingerprint": "11b5061f5dd002a2c068f5d2bf190065d92520b67c66d419218fee3a090d5b2a6803643a6d59df6792aa22ce195ad74fa1ca0250c2316aafa36cf29b1b7ffe11_0", "is_ignored": false, "lines": "            out.println(name);", "message": "Detected a request with potential user-input going into a OutputStream or Writer object. This bypasses any view or template environments, including HTML escaping, which may expose this application to cross-site scripting (XSS) vulnerabilities. Consider using a view technology such as JavaServer Faces (JSFs) which automatically escapes HTML views.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "interfile": true, "license": "proprietary license - copyright \u00a9 Semgrep, Inc.", "likelihood": "HIGH", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://www3.ntu.edu.sg/home/ehchua/programming/java/JavaServerFaces.html"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9211, "rule_id": "j2Uv7B", "rv_id": 904971, "url": "https://semgrep.dev/playground/r/l4TXK23/java.lang.security.audit.xss.no-direct-response-writer.no-direct-response-writer", "version_id": "l4TXK23"}}, "shortlink": "https://sg.run/KlRL", "source": "https://semgrep.dev/r/java.lang.security.audit.xss.no-direct-response-writer.no-direct-response-writer", "subcategory": ["vuln"], "technology": ["java", "servlets"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$1": {"abstract_content": "getParameter", "end": {"col": 13, "line": 1, "offset": 12}, "start": {"col": 1, "line": 1, "offset": 0}}, "$REQ": {"abstract_content": "request", "end": {"col": 32, "line": 35, "offset": 1076}, "start": {"col": 25, "line": 35, "offset": 1069}}, "$REQFUNC": {"abstract_content": "getParameter", "end": {"col": 45, "line": 35, "offset": 1089}, "start": {"col": 33, "line": 35, "offset": 1077}}, "$WRITE": {"abstract_content": "println", "end": {"col": 24, "line": 54, "offset": 1916}, "start": {"col": 17, "line": 54, "offset": 1909}}, "$WRITER": {"abstract_content": "out", "end": {"col": 16, "line": 54, "offset": 1908}, "propagated_value": {"svalue_abstract_content": "response.getWriter()", "svalue_end": {"col": 47, "line": 33, "offset": 1029}, "svalue_start": {"col": 27, "line": 33, "offset": 1009}}, "start": {"col": 13, "line": 54, "offset": 1905}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/XPathQuery.java", "start": {"col": 13, "line": 54, "offset": 1905}}, {"check_id": "java.lang.security.audit.xxe.documentbuilderfactory-disallow-doctype-decl-missing.documentbuilderfactory-disallow-doctype-decl-missing", "end": {"col": 66, "line": 46, "offset": 1554}, "extra": {"dataflow_trace": {"intermediate_vars": [{"content": "factory", "location": {"end": {"col": 41, "line": 45, "offset": 1448}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/xxe.java", "start": {"col": 34, "line": 45, "offset": 1441}}}], "taint_sink": ["CliLoc", [{"end": {"col": 66, "line": 46, "offset": 1554}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/xxe.java", "start": {"col": 11, "line": 46, "offset": 1499}}, "DocumentBuilder builder = factory.newDocumentBuilder();"]], "taint_source": ["CliLoc", [{"end": {"col": 81, "line": 45, "offset": 1488}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/xxe.java", "start": {"col": 11, "line": 45, "offset": 1418}}, "DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();"]]}, "engine_kind": "OSS", "fingerprint": "152bd506a19fa414d517f94377eba1c0e955e31bf0e96ee9f1f585d0c3533989df0a6cd23ddfcba2f61a7ee91a4bbc49d3ee25117aeda7e3b6ad0b0d76535e14_0", "fix": "factory.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", true);\n          factory.newDocumentBuilder();", "is_ignored": false, "lines": "          DocumentBuilder builder = factory.newDocumentBuilder();", "message": "DOCTYPE declarations are enabled for this DocumentBuilderFactory. This is vulnerable to XML external entity attacks. Disable this by setting the feature \"http://apache.org/xml/features/disallow-doctype-decl\" to true. Alternatively, allow DOCTYPE declarations and only prohibit external entities declarations. This can be done by setting the features \"http://xml.org/sax/features/external-general-entities\" and \"http://xml.org/sax/features/external-parameter-entities\" to false.", "metadata": {"asvs": {"control_id": "5.5.2 Insecue XML Deserialization", "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v55-deserialization-prevention", "section": "V5 Validation, Sanitization and Encoding", "version": "4"}, "category": "security", "confidence": "HIGH", "cwe": ["CWE-611: Improper Restriction of XML External Entity Reference"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A04:2017 - XML External Entities (XXE)", "A05:2021 - Security Misconfiguration"], "references": ["https://semgrep.dev/blog/2022/xml-security-in-java", "https://semgrep.dev/docs/cheat-sheets/java-xxe/", "https://blog.sonarsource.com/secure-xml-processor", "https://xerces.apache.org/xerces2-j/features.html"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 18245, "rule_id": "10UPQB", "rv_id": 833986, "url": "https://semgrep.dev/playground/r/O9TJWWv/java.lang.security.audit.xxe.documentbuilderfactory-disallow-doctype-decl-missing.documentbuilderfactory-disallow-doctype-decl-missing", "version_id": "O9TJWWv"}}, "shortlink": "https://sg.run/PYBz", "source": "https://semgrep.dev/r/java.lang.security.audit.xxe.documentbuilderfactory-disallow-doctype-decl-missing.documentbuilderfactory-disallow-doctype-decl-missing", "subcategory": ["vuln"], "technology": ["java", "xml"], "vulnerability_class": ["XML Injection"]}, "metavars": {"$FACTORY": {"abstract_content": "factory", "end": {"col": 41, "line": 45, "offset": 1448}, "start": {"col": 34, "line": 45, "offset": 1441}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/xxe.java", "start": {"col": 11, "line": 46, "offset": 1499}}, {"check_id": "java.lang.security.audit.xss.no-direct-response-writer.no-direct-response-writer", "end": {"col": 115, "line": 54, "offset": 2019}, "extra": {"dataflow_trace": {"intermediate_vars": [{"content": "xml", "location": {"end": {"col": 26, "line": 44, "offset": 1381}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/xxe.java", "start": {"col": 23, "line": 44, "offset": 1378}}}, {"content": "is", "location": {"end": {"col": 25, "line": 47, "offset": 1579}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/xxe.java", "start": {"col": 23, "line": 47, "offset": 1577}}}, {"content": "doc", "location": {"end": {"col": 23, "line": 48, "offset": 1628}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/xxe.java", "start": {"col": 20, "line": 48, "offset": 1625}}}, {"content": "element", "location": {"end": {"col": 26, "line": 49, "offset": 1675}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/xxe.java", "start": {"col": 19, "line": 49, "offset": 1668}}}, {"content": "nodes", "location": {"end": {"col": 25, "line": 50, "offset": 1728}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/xxe.java", "start": {"col": 20, "line": 50, "offset": 1723}}}], "taint_sink": ["CliLoc", [{"end": {"col": 115, "line": 54, "offset": 2019}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/xxe.java", "start": {"col": 13, "line": 54, "offset": 1917}}, "out.print(nodes.item(i).getNodeName()+\" : \" + nodes.item(i).getFirstChild().getNodeValue().toString())"]], "taint_source": ["CliLoc", [{"end": {"col": 51, "line": 44, "offset": 1406}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/xxe.java", "start": {"col": 27, "line": 44, "offset": 1382}}, "request.getInputStream()"]]}, "engine_kind": "OSS", "fingerprint": "88bc92ec6233e8efcf4bd2baa5f2c41473945da37aa8664049bc38b51e334d56090688fe235d6be699dc28170c9352482de33bcb711fecd64ae4a9bedc80b814_0", "is_ignored": false, "lines": "            out.print(nodes.item(i).getNodeName()+\" : \" + nodes.item(i).getFirstChild().getNodeValue().toString());", "message": "Detected a request with potential user-input going into a OutputStream or Writer object. This bypasses any view or template environments, including HTML escaping, which may expose this application to cross-site scripting (XSS) vulnerabilities. Consider using a view technology such as JavaServer Faces (JSFs) which automatically escapes HTML views.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "interfile": true, "license": "proprietary license - copyright \u00a9 Semgrep, Inc.", "likelihood": "HIGH", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://www3.ntu.edu.sg/home/ehchua/programming/java/JavaServerFaces.html"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9211, "rule_id": "j2Uv7B", "rv_id": 904971, "url": "https://semgrep.dev/playground/r/l4TXK23/java.lang.security.audit.xss.no-direct-response-writer.no-direct-response-writer", "version_id": "l4TXK23"}}, "shortlink": "https://sg.run/KlRL", "source": "https://semgrep.dev/r/java.lang.security.audit.xss.no-direct-response-writer.no-direct-response-writer", "subcategory": ["vuln"], "technology": ["java", "servlets"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$1": {"abstract_content": "getInputStream", "end": {"col": 15, "line": 1, "offset": 14}, "start": {"col": 1, "line": 1, "offset": 0}}, "$REQ": {"abstract_content": "request", "end": {"col": 34, "line": 44, "offset": 1389}, "start": {"col": 27, "line": 44, "offset": 1382}}, "$REQFUNC": {"abstract_content": "getInputStream", "end": {"col": 49, "line": 44, "offset": 1404}, "start": {"col": 35, "line": 44, "offset": 1390}}, "$WRITE": {"abstract_content": "print", "end": {"col": 22, "line": 54, "offset": 1926}, "start": {"col": 17, "line": 54, "offset": 1921}}, "$WRITER": {"abstract_content": "out", "end": {"col": 16, "line": 54, "offset": 1920}, "start": {"col": 13, "line": 54, "offset": 1917}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/controller/xxe.java", "start": {"col": 13, "line": 54, "offset": 1917}}, {"check_id": "java.lang.security.audit.crypto.use-of-md5.use-of-md5", "end": {"col": 63, "line": 16, "offset": 346}, "extra": {"engine_kind": "OSS", "fingerprint": "613c0b7c749bbe26f831c21944adb562e5ccdb6130899d3f7c79a3be96fb2858bd7d1c90eee324b100bb95d9d05a2d3d4361fd46b3eaa43e9b54fdff9ef2fef0_0", "fix": "\"SHA-512\"", "is_ignored": false, "lines": "            MessageDigest md = MessageDigest.getInstance(\"MD5\");", "message": "Detected MD5 hash algorithm which is considered insecure. MD5 is not collision resistant and is therefore not suitable as a cryptographic signature. Use HMAC instead.", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-328: Use of Weak Hash"], "functional-categories": ["crypto::search::hash-algorithm::java.security"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A03:2017 - Sensitive Data Exposure", "A02:2021 - Cryptographic Failures"], "references": ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 17325, "rule_id": "KxU5lW", "rv_id": 833941, "url": "https://semgrep.dev/playground/r/3ZT3A03/java.lang.security.audit.crypto.use-of-md5.use-of-md5", "version_id": "3ZT3A03"}}, "shortlink": "https://sg.run/ryJn", "source": "https://semgrep.dev/r/java.lang.security.audit.crypto.use-of-md5.use-of-md5", "source-rule-url": "https://find-sec-bugs.github.io/bugs.htm#WEAK_MESSAGE_DIGEST_MD5", "subcategory": ["vuln"], "technology": ["java"], "vulnerability_class": ["Insecure Hashing Algorithm"]}, "metavars": {"$1": {"abstract_content": "\"MD5\"", "end": {"col": 6, "line": 1, "offset": 5}, "start": {"col": 1, "line": 1, "offset": 0}}, "$ALGO": {"abstract_content": "\"MD5\"", "end": {"col": 63, "line": 16, "offset": 346}, "start": {"col": 58, "line": 16, "offset": 341}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/Users/USERNAME/Downloads/JavaVulnerableLab-master/src/main/java/org/cysecurity/cspf/jvl/model/HashMe.java", "start": {"col": 58, "line": 16, "offset": 341}}], "skipped_rules": [], "version": "1.92.0"}